import{j as e,r as s,A as v}from"./index-DWis4S1t.js";import{S as o}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{M as N}from"./AddyMine-CwKyk6rd.js";import{B as S}from"./BeatLoader-CfJHUm3g.js";const E=({task:t,onWatchCodeClick:n,alertViewed:a})=>e.jsx("section",{className:"flex justify-center items-center mx-6 mb-14",children:e.jsxs("div",{className:"bg-[var(--container-bg-color)] text-[var(--highlight-color)] cards-container flex max-w-[850px] flex-wrap w-full justify-center gap-6 rounded-md",children:[e.jsxs("div",{className:"w-full flex-grow min-h-16 flex justify-center flex-col items-center rounded-md",children:[e.jsx("h2",{className:"w-full text-center",children:"INSTRUCTIONS"}),e.jsx("b",{children:t.instructions})]},t._id),e.jsx("div",{onClick:t.justViewed?a:n,className:"basis-80 flex-grow min-h-16 flex justify-center items-center rounded-md bg-[var(--accent-color)] max-w-[400px]",children:e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:`${t.justViewed?"text-[var(--bad)]":"text-[var(--good)]"} w-full rounded text-center`,children:t.justViewed?"Done":"Do Task"})})]})}),P=({videoId:t,isOpen:n,onClose:a})=>{const{getStoredUserObj:k,getStoredToken:f}=s.useContext(v),{API_MineBase_url:g,API_E_VideoBase_url:C,tasks:T,setTasks:b,setBalance:j}=s.useContext(N),[i,p]=s.useState(""),[l,c]=s.useState(!1),w=()=>i.trim()?!0:(o.fire("Watchcode cannot be empty"),!1),y=async d=>{if(d.preventDefault(),c(!0),!w()){c(!1);return}try{console.log("WatchcodeModal videoId",t);const r=await(await fetch(`${g}api/a/v1.00/coinmining`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${f()}`},body:JSON.stringify({watchcode:i,videoId:t})})).json();if(console.log("data",r),r&&r.alreadydone)o.fire(`${r.alreadydone}`);else if(r&&r.data)o.fire(`${r.data.newCoins} shares mined successfully`),b(x=>{console.log("Previous tasks:",x);const m=x.map(h=>h._id===t?{...h,justViewed:!0}:h);return console.log("Updated tasks:",m),m}),j(r.data),a();else throw new Error("Invalid response data")}catch(u){console.error("Shares mining failed:",u),o.fire("Shares mining failed")}finally{c(!1)}};return e.jsx(e.Fragment,{children:n&&e.jsx("div",{id:"watchcodeModal",className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center max-h-[95vh] overflow-y-scroll z-[101] my-5",children:e.jsxs("div",{className:"bg-white dark:bg-black rounded-lg shadow-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-primary",children:"Submit Watchcode"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-800 dark:text-gray-300 dark:hover:text-white rounded-full",children:"âœ–"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsx("input",{type:"hidden",name:"video-id",value:t}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"watchcode",className:"block font-bold text-primary mb-2",children:"Watchcode"}),e.jsx("textarea",{id:"watchcode",name:"watchcode",rows:"2",placeholder:"Enter the watchcode here",value:i,onChange:d=>p(d.target.value),required:!0,className:"w-full p-3 text-[var(--secondary-text-color)] border border-gray-300 dark:border-gray-700 rounded focus:ring focus:ring-highlight-color transition duration-200 ease-in-out"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"submit",className:"bg-highlight-color hover:bg-secondary-accent-color text-white font-bold py-3 px-6 rounded-lg transition duration-200 ease-in-out",disabled:l,children:l?e.jsx(S,{color:"#ffffff",loading:l,size:8}):"Mine"})})]})]})})})};export{E as T,P as W};
