import{r as a,A as z,u as M,j as e,L as B}from"./index-CjYO5HdS.js";import{S as i}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{A as O}from"./AuthHelmet-EAF1nPXA.js";import{C as Z}from"./ConfirmPasswordStrengthModal-L48ll7sT.js";import{B as I}from"./BeatLoader-Cw3v0UOt.js";import"./Helmet-DlaOlHX7.js";const V=()=>{const{API_base_url:C,StoreToken:k,StoreUserObj:R,getReferalId:g,setPageTitle:h,APP_NAME:x}=a.useContext(z);a.useEffect(()=>(h(""),()=>{}),[h]);const b=M(),[c,m]=a.useState(!1),[p,v]=a.useState(!1),[w,P]=a.useState(""),[f,S]=a.useState(!1),y=a.useRef(null),s=a.useRef(!0),[o,N]=a.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",gender:"",referredByRef:"",userTitle:""}),E=t=>{console.log("response",t),s.current=t,S(t),t&&y.current.click(),console.log("Confirmed",f),v(!1)},l=t=>{N({...o,[t.target.name]:t.target.value})},T=()=>{console.log("formData",o),g()&&N({...o,referredByRef:g()});let{firstName:t,lastName:u,email:d,password:r,confirmPassword:j,gender:L,userTitle:n}=o;if(!t||!u||!d||!r||!j||!L)return P("Please fill in all required fields"),i.fire("Please fill in all required fields."),!1;if(r!==j)return i.fire("Passwords do not match."),!1;if(r.length<8)return i.fire("Passwords must be at least 8 characters"),!1;if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(d))return i.fire("Email is not a valid email"),!1;if(n&&!/^[a-zA-Z0-9\s,'.-]{2,50}$/.test(n))return i.fire(`Title "${n}" is not valid. Please use 2-50 characters, including letters, numbers, spaces, commas, apostrophes, hyphens, or dots only.`),!1;if(n&&!/\.\s*$/.test(n.trim())&&(n=`${n.trim()}.`),console.log("Confirmed status:",f,"Proceed status:",s.current),!f&&!p){const F=/[a-z]/.test(r),$=/[A-Z]/.test(r),q=/[0-9]/.test(r),D=/[!@#$%^&*]/.test(r);if(!F||!$||!q||!D)return console.log("Password strength check failed"),v(!0),s.current=!1,!1}return console.log("proceed2",s.current),s.current},A=async t=>{t.preventDefault(),console.log("handleSubmit RAN"),m(!0),s.current=!0,console.log("handleSubmit proceed0",s.current),console.log(c?"isLoading 1 true":"isLoading 1 false");let u=T();if(console.log("rest",u),!u){console.log("form validation failed"),m(!1);return}m(!0),console.log(c?"isLoading 2 true":"isLoading 2 false"),console.log("formData",o);try{console.log("GOT HERE");const r=await(await fetch(`${C}api/a/v1.00/users/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(r.status!=="success")throw new Error(r.message);console.log(r),console.log(r.token),r.token&&k(r.token),r.data&&R(r.data),i.fire("Registration successful, you have been successfully logged in and will be redirected to the home page"),console.log("data",r),r.data.role.includes("user")?b("/in/home"):b("/")}catch(d){let r="";/E11000/.test(d)?r=`registration detail rejected,
 please try another account detail`:r=d,console.error(`Registration failed: ${r}`),i.fire(`Registration failed:
 ${r}`)}m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(O,{pageDescription:`Welcome to ${x.toLowerCase()} registration/signup page.`,pageName:"register",pageTitle:` ${x} - Registration/sign-up`}),e.jsxs("div",{className:"container my-8 mx-auto max-w-md p-6 bg-[var(--container-bg-color)] border border-[var(--container-border)] rounded-lg shadow-lg",children:[e.jsx("div",{className:"formHeader mb-6 rounded-md",children:e.jsx("h1",{className:"text-2xl font-bold text-[var(--primary-text-color)] text-center",children:"Register"})}),e.jsxs("form",{children:[w&&e.jsx("div",{className:"error-message",children:w}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"firstName",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",value:o.firstName,onChange:l,required:!0,id:"firstName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:o.lastName,onChange:l,required:!0,id:"lastName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"userTitle",children:"Your Title ( If any )"}),e.jsx("input",{type:"text",name:"userTitle",value:o.userTitle,onChange:l,id:"userTitle",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:l,required:!0,id:"email",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsxs("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"password",children:["Password ",e.jsx("em",{children:"(at least 8 chars.)"})]}),e.jsx("input",{type:"password",name:"password",value:o.password,onChange:l,required:!0,id:"password",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:o.confirmPassword,onChange:l,required:!0,id:"confirmPassword",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"gender",children:"Gender:"}),e.jsxs("select",{name:"gender",value:o.gender,onChange:l,required:!0,id:"gender",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md",children:[e.jsx("option",{value:"",children:"-- Select Gender --"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("button",{ref:y,onClick:A,type:"submit",className:"w-full mt-7 py-2 bg-[var(--highlight-color)] text-white rounded hover:bg-[var(--secondary-accent-color)] transition duration-300",children:c?e.jsx(I,{color:"#ffffff",loading:c,size:8}):"Register"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(B,{to:"/login",className:"text-[var(--accent-color)] hover:text-[var(--highlight-color)]",children:"Back to Login"})})]}),p&&e.jsx(Z,{handleConfirm:E})]})};export{V as default};
