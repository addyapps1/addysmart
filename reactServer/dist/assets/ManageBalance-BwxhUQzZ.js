import{r as s,A as T,u as A,j as t}from"./index-CxbHE0pI.js";import{M as I}from"./AddyMine-WSYQUIhP.js";import{T as U,W as B}from"./WatchcodeModal-D2185UD9.js";import{S as L}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{B as b}from"./BeatLoader-Pg87K8qw.js";import"./useClickOutside-B_P1bOg4.js";import"./line-md--menu-to-close-transition-CEm-3zyw.js";const z=()=>{var x,u,g;const{logout:h,isLoggedIn:n,getStoredUserObj:i,getStoredToken:j,setPageTitle:l}=s.useContext(T),{API_MineBase_url:v,tasks:c,setTasks:w}=s.useContext(I),[f,d]=s.useState(!1),[o,N]=s.useState({}),[C,m]=s.useState(null),[E,p]=s.useState(!1),r=A();s.useEffect(()=>{n()||r("/")},[n,r]),s.useEffect(()=>(l("MAMAGEBALANCE"),()=>{}),[l]),s.useEffect(()=>{N(i())},[i]);const M=async()=>{d(!0);try{const e=`${v()}api/a/v1.00/evideo/tasks`,a=await(await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",authorization:`Bearer ${j()}`}})).json();if(a.status==="success"&&a.data)w(a.data);else throw new Error(a.message)}catch(e){(e=="Error: jwt expired"||e=="Error: Device mismatch. Please login again")&&(L.fire("Your login expired, please login again."),h(),r("/")),console.error("Request failed:",e)}finally{d(!1)}};s.useEffect(()=>{M()},[]);const y=e=>{m(e),p(!0)},S=()=>{p(!1),m(null)};return t.jsxs(t.Fragment,{children:[t.jsx("section",{className:"flex justify-center items-center mx-6 mb-6 mt-10",children:t.jsx("div",{className:"cards-container flex max-w-[850px] flex-wrap w-full justify-center gap-6",children:t.jsxs("div",{className:"bg-[var(--container-bg-color)] w-full flex-grow min-h-16 flex-col flex justify-center items-center rounded-md",children:[t.jsx("h1",{className:"w-full text-center mt-5 m-0 text-[var(--highlight-color)] text-2xl",children:`${((x=o.userTitle)==null?void 0:x.toUpperCase())||"ff"} 
              ${((u=o.firstName)==null?void 0:u.toUpperCase())||"ff"} 
              ${((g=o.lastName)==null?void 0:g.toUpperCase())||"ff"}`}),t.jsxs("p",{className:"w-full text-center mb-2 px-3",children:["Mine real shares and get paid every month"," "]})]})})}),f?t.jsx("div",{className:"flex justify-center items-center mt-10",children:t.jsx(b,{color:"#ffffff",loading:f,size:8})}):c.length>0?c.map(e=>t.jsx("div",{className:"task-item",children:t.jsx(U,{title:e.title,description:e.description,image:e.image,onWatchCodeClick:()=>y(e.videoId)})},e._id)):t.jsx("p",{className:"text-center",children:"No record yet."}),t.jsx(B,{videoId:C,isOpen:E,onClose:S})]})};export{z as default};
