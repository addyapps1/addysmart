import{r as a,A as M,u as B,j as e,L as O}from"./index-kR-aReZW.js";import{S as d}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{A as Z}from"./AuthHelmet-BWGd4pJI.js";import{C as I}from"./ConfirmPasswordStrengthModal-DfuEUH40.js";import{B as W}from"./BeatLoader-14DkuQDB.js";import"./Helmet-CjJ5bfs9.js";const X=()=>{const{API_base_url:C,StoreToken:k,StoreUserObj:R,getReferalId:h,setPageTitle:x,APP_NAME:b}=a.useContext(M);a.useEffect(()=>(x(""),()=>{}),[x]);const p=B(),[m,u]=a.useState(!1),[v,w]=a.useState(!1),[y,P]=a.useState(""),[f,T]=a.useState(!1),N=a.useRef(null),s=a.useRef(!0),[t,g]=a.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",gender:"",referredByRef:"",userTitle:""}),S=o=>{console.log("response",o),s.current=o,T(o),o&&N.current.click(),console.log("Confirmed",f),w(!1)},E=()=>{const o=/\.\s*$/;t.userTitle&&!o.test(t.userTitle.trim())&&g(i=>({...i,userTitle:`${i.userTitle.trim()}.`}))},l=o=>{g({...t,[o.target.name]:o.target.value})},A=()=>{console.log("formData",t),h()&&g({...t,referredByRef:h()});let{firstName:o,lastName:i,email:c,password:r,confirmPassword:j,gender:$,userTitle:n}=t;if(!o||!i||!c||!r||!j||!$)return P("Please fill in all required fields"),d.fire("Please fill in all required fields."),!1;if(r!==j)return d.fire("Passwords do not match."),!1;if(r.length<8)return d.fire("Passwords must be at least 8 characters"),!1;if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(c))return d.fire("Email is not a valid email"),!1;if(n&&!/^[a-zA-Z0-9\s,'.-]{2,50}$/.test(n))return d.fire(`Title "${n}" is not valid. Please use 2-50 characters, including letters, numbers, spaces, commas, apostrophes, hyphens, or dots only.`),!1;if(n&&!/\.\s*$/.test(n.trim())&&(n=`${n.trim()}.`),console.log("Confirmed status:",f,"Proceed status:",s.current),!f&&!v){const F=/[a-z]/.test(r),D=/[A-Z]/.test(r),q=/[0-9]/.test(r),z=/[!@#$%^&*]/.test(r);if(!F||!D||!q||!z)return console.log("Password strength check failed"),w(!0),s.current=!1,!1}return console.log("proceed2",s.current),s.current},L=async o=>{o.preventDefault(),console.log("handleSubmit RAN"),u(!0),s.current=!0,console.log("handleSubmit proceed0",s.current),console.log(m?"isLoading 1 true":"isLoading 1 false"),E();let i=A();if(console.log("rest",i),!i){console.log("form validation failed"),u(!1);return}u(!0),console.log(m?"isLoading 2 true":"isLoading 2 false"),console.log("formData",t);try{console.log("GOT HERE");const r=await(await fetch(`${C}api/a/v1.00/users/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.status!=="success")throw new Error(r.message);console.log(r),console.log(r.token),r.token&&k(r.token),r.data&&R(r.data),d.fire("Registration successful, you have been successfully logged in and will be redirected to the home page"),console.log("data",r),r.data.role.includes("user")?p("/in/home"):p("/")}catch(c){let r="";/E11000/.test(c)?r=`registration detail rejected,
 please try another account detail`:r=c,console.error(`Registration failed: ${r}`),d.fire(`Registration failed:
 ${r}`)}u(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{pageDescription:`Welcome to ${b.toLowerCase()} registration/signup page.`,pageName:"register",pageTitle:` ${b} - Registration/sign-up`}),e.jsxs("div",{className:"container my-8 mx-auto max-w-md p-6 bg-[var(--container-bg-color)] border border-[var(--container-border)] rounded-lg shadow-lg",children:[e.jsx("div",{className:"formHeader mb-6 rounded-md",children:e.jsx("h1",{className:"text-2xl font-bold text-[var(--primary-text-color)] text-center",children:"Register"})}),e.jsxs("form",{children:[y&&e.jsx("div",{className:"error-message",children:y}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"firstName",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",value:t.firstName,onChange:l,required:!0,id:"firstName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:t.lastName,onChange:l,required:!0,id:"lastName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"userTitle",children:"Your Title ( If any )"}),e.jsx("input",{type:"text",name:"userTitle",value:t.userTitle,onChange:l,id:"userTitle",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:l,required:!0,id:"email",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsxs("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"password",children:["Password ",e.jsx("em",{children:"(at least 8 chars.)"})]}),e.jsx("input",{type:"password",name:"password",value:t.password,onChange:l,required:!0,id:"password",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:l,required:!0,id:"confirmPassword",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"gender",children:"Gender:"}),e.jsxs("select",{name:"gender",value:t.gender,onChange:l,required:!0,id:"gender",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md",children:[e.jsx("option",{value:"",children:"-- Select Gender --"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("button",{ref:N,onClick:L,type:"submit",className:"w-full mt-7 py-2 bg-[var(--highlight-color)] text-white rounded hover:bg-[var(--secondary-accent-color)] transition duration-300",children:m?e.jsx(W,{color:"#ffffff",loading:m,size:8}):"Register"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(O,{to:"/login",className:"text-[var(--accent-color)] hover:text-[var(--highlight-color)]",children:"Back to Login"})})]}),v&&e.jsx(I,{handleConfirm:S})]})};export{X as default};
