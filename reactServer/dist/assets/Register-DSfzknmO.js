import{r as a,A as M,u as B,j as e,L as O}from"./index-CxbHE0pI.js";import{S as i}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{A as Z}from"./AuthHelmet-Cyz0AqrJ.js";import{C as I}from"./ConfirmPasswordStrengthModal-BvIlMVIM.js";import{B as _}from"./BeatLoader-Pg87K8qw.js";import"./Helmet-CSCbi4JC.js";const V=()=>{const{API_base_url:C,StoreToken:k,StoreUserObj:P,getReferalId:h,setPageTitle:x,APP_NAME:b}=a.useContext(M);a.useEffect(()=>(x(""),()=>{}),[x]);const p=B(),[c,m]=a.useState(!1),[v,w]=a.useState(!1),[y,R]=a.useState(""),[u,T]=a.useState(!1),N=a.useRef(null),s=a.useRef(!0),[o,f]=a.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",gender:"",referredByRef:"",userTitle:""}),S=t=>{console.log("response",t),s.current=t,T(t),t&&N.current.click(),console.log("Confirmed",u),w(!1)},A=()=>{const t=/\.\s*$/;o.userTitle&&!t.test(o.userTitle.trim())&&f(n=>({...n,userTitle:`${n.userTitle.trim()}.`}))},l=t=>{f({...o,[t.target.name]:t.target.value})},E=()=>{console.log("formData",o),h()&&f({...o,referredByRef:h()});let{firstName:t,lastName:n,email:d,password:r,confirmPassword:j,gender:F,userTitle:g}=o;if(!t||!n||!d||!r||!j||!F)return R("Please fill in all required fields"),i.fire("Please fill in all required fields."),!1;if(r!==j)return i.fire("Passwords do not match."),!1;if(r.length<8)return i.fire("Passwords must be at least 8 characters"),!1;if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(d))return i.fire("Email is not a valid email"),!1;if(g&&!/^[a-zA-Z0-9\s,'.-]{2,50}$/.test(g))return i.fire(`Title "${g}" is not valid. Please use 2-50 characters, including letters, numbers, spaces, commas, apostrophes, hyphens, or dots only.`),!1;if(console.log("Confirmed status:",u,"Proceed status:",s.current),!u&&!v){const $=/[a-z]/.test(r),q=/[A-Z]/.test(r),D=/[0-9]/.test(r),z=/[!@#$%^&*]/.test(r);if(!$||!q||!D||!z)return console.log("Password strength check failed"),w(!0),s.current=!1,!1}return console.log("proceed2",s.current),s.current},L=async t=>{t.preventDefault(),console.log("handleSubmit RAN"),m(!0),s.current=!0,console.log("handleSubmit proceed0",s.current),console.log(c?"isLoading 1 true":"isLoading 1 false"),A();let n=E();if(console.log("rest",n),!n){console.log("form validation failed"),m(!1);return}m(!0),console.log(c?"isLoading 2 true":"isLoading 2 false"),console.log("formData",o);try{console.log("GOT HERE");const r=await(await fetch(`${C()}api/a/v1.00/users/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(r.status!=="success")throw new Error(r.message);console.log(r),console.log(r.token),r.token&&k(r.token),r.data&&P(r.data),i.fire("Registration successful, you have been successfully logged in and will be redirected to the home page"),console.log("data",r),r.data.role.includes("user")?p("/in/home"):p("/")}catch(d){let r="";/E11000/.test(d)?r=`registration detail rejected,
 please try another account detail`:r=d,console.error(`Registration failed: ${r}`),i.fire(`Registration failed:
 ${r}`)}m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{pageDescription:`Welcome to ${b.toLowerCase()} registration/signup page.`,pageName:"register",pageTitle:` ${b} - Registration/sign-up`}),e.jsxs("div",{className:"container my-8 mx-auto max-w-md p-6 bg-[var(--container-bg-color)] border border-[var(--container-border)] rounded-lg shadow-lg",children:[e.jsx("div",{className:"formHeader mb-6 rounded-md",children:e.jsx("h1",{className:"text-2xl font-bold text-[var(--primary-text-color)] text-center",children:"Register"})}),e.jsxs("form",{children:[y&&e.jsx("div",{className:"error-message",children:y}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"firstName",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",value:o.firstName,onChange:l,required:!0,id:"firstName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:o.lastName,onChange:l,required:!0,id:"lastName",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"userTitle",children:"Your Title ( If any )"}),e.jsx("input",{type:"text",name:"userTitle",value:o.userTitle,onChange:l,id:"userTitle",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:l,required:!0,id:"email",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsxs("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"password",children:["Password ",e.jsx("em",{children:"(at least 8 chars.)"})]}),e.jsx("input",{type:"password",name:"password",value:o.password,onChange:l,required:!0,id:"password",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",value:o.confirmPassword,onChange:l,required:!0,id:"confirmPassword",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md"}),e.jsx("label",{className:"block mb-2 text-[var(--primary-text-color)] font-bold",htmlFor:"gender",children:"Gender:"}),e.jsxs("select",{name:"gender",value:o.gender,onChange:l,required:!0,id:"gender",className:"mb-4 p-2 w-full border rounded text-[var(--secondary-text-color)] border-[var(--dark-gray)] focus:border-[var(--highlight-color)] focus:shadow-md",children:[e.jsx("option",{value:"",children:"-- Select Gender --"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("button",{ref:N,onClick:L,type:"submit",className:"w-full mt-7 py-2 bg-[var(--highlight-color)] text-white rounded hover:bg-[var(--secondary-accent-color)] transition duration-300",children:c?e.jsx(_,{color:"#ffffff",loading:c,size:8}):"Register"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(O,{to:"/login",className:"text-[var(--accent-color)] hover:text-[var(--highlight-color)]",children:"Back to Login"})})]}),v&&e.jsx(I,{handleConfirm:S})]})};export{V as default};
